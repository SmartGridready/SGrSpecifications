<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/SGr.xsl"?>
<FunctionalProfileFrame xmlns="http://www.smartgridready.com/ns/V0/"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.smartgridready.com/ns/V0/ ../../SchemaDatabase/SGr/SGrIncluder.xsd">
  <releaseNotes>
    <state>Published</state>
    <changeLog>
      <version>1.0.0</version>
      <date>2026-01-05</date>
      <author>Ergo/ag,SGr/mkr</author>
      <comment>Finalization</comment>
    </changeLog>
  </releaseNotes>
  <functionalProfile>
    <functionalProfileIdentification>
      <specificationOwnerIdentification>0</specificationOwnerIdentification>
      <functionalProfileCategory>SGCP</functionalProfileCategory>
      <functionalProfileType>FlexMgmt</functionalProfileType>
      <levelOfOperation>4m</levelOfOperation>
      <versionNumber>
        <primaryVersionNumber>1</primaryVersionNumber>
        <secondaryVersionNumber>0</secondaryVersionNumber>
        <subReleaseVersionNumber>0</subReleaseVersionNumber>
      </versionNumber>
    </functionalProfileIdentification>
    <legibleDescription>
      <textElement>
        <![CDATA[
          <p><img src="ressources/fp_ems_to_pv_wp_evse.svg"/></p>
          <p>Functional profile for energy management systems (EMS) that have a bidirectional communication interface to a flexibility manager (e.g., TSO/ DSO).
          The interface enables both the retrieval of current data and the targeted control of power at the grid connection point via defined data points.</p>
          <p>The data is divided into three categories:</p>
          <ul>
            <li>
              <h3>Settings (read):</h3>
              Static installation data such as address, meter number, and installed flexibilities.
            </li>
            <li>
              <h3>Data (read):</h3>
              Dynamic information, such as current PV production or power at the grid connection point.
            </li>
            <li>
              <h3>Power restriction (control):</h3>
              Temporary restriction of the allowed power range at the grid connection point by setting both a minimum and a maximum value (positive values for consumption, negative for feed-in). This allows, for example, to set the feed-in to 0 or to define a specific allowed range.
            </li>
          </ul>
          <p>The data points are transmitted in JSON format, which allows multiple data points to be updated simultaneously with a single query, thereby reducing network traffic.</p>
        ]]>
      </textElement>
      <language>en</language>
    </legibleDescription>
    <legibleDescription>
      <textElement>
        <![CDATA[
          <p><img src="ressources/fp_ems_to_pv_wp_evse.svg"/></p>
          <p>Funktionsprofil für Energiemanagement-Systeme (EMS), welche über eine bidirektionale Kommunikationsschnittstelle zu einem Flexibilitäts-Manager (z.B. EVU / VNB) verfügen.
          Die Schnittstelle ermöglicht sowohl das Abrufen aktueller Daten als auch die gezielte Steuerung der Leistung am Netzanschlusspunkt über definierte Datenpunkte.</p>
          <p>Die Daten werden in drei Kategorien unterteilt:</p>
          <ul>
            <li>
              <h3>Einstellungen (Lesen):</h3>
              Statische Installationsdaten wie Adresse, Zählernummer und installierte Flexibilitäten.
            </li>
            <li>
              <h3>Daten (Lesen):</h3>
              Dynamische Informationen, beispielsweise die aktuelle PV-Produktion oder die Leistung am Netzanschlusspunkt.
            </li>
            <li>
              <h3>Leistungsbeschränkung (Steuern):</h3>
              Zeitlich begrenzte Einschränkung des zulässigen Leistungsbereichs am Netzanschlusspunkt durch Setzen eines Minimal- und eines Maximalwerts (positive Werte für Bezug, negative für Einspeisung). Damit kann z.B. die Einspeisung auf 0 gesetzt oder ein spezifischer Bereich definiert werden.
            </li>
          </ul>
          <p>Die Datenpunkte werden im JSON-Format übertragen, was die gleichzeitige Aktualisierung mehrerer Daten mit einer einzigen Abfrage ermöglicht und so den Netzwerkverkehr reduziert.</p>
        ]]>
      </textElement>
      <language>de</language>
    </legibleDescription>
  </functionalProfile>
  <dataPointList>
    <dataPointListElement>
      <dataPoint>
        <dataPointName>GetSettings</dataPointName>
        <dataDirection>R</dataDirection>
        <presenceLevel>R</presenceLevel>
        <dataType>
          <json />
        </dataType>
        <unit>NONE</unit>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Reading static installation data such as address, meter number, and installed flexibilities.</p>

Schema of the returned JSON object:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Settings",
  "description": "Current settings",
  "type": "object",
  "properties": {
    "Address": {
      "description": "Address of the energy manager",
      "type": "object",
      "properties": {
        "Street": {
          "description": "Street and number",
          "type": "string"
        },
        "ZipCode": {
          "description": "Zip code",
          "type": "string",
        },
        "City": {
          "description": "Location",
          "type": "string"
        }
      },
      "required": [
        "Street", "ZipCode", "City"
      ]
    },
    "MeterNumber": {
      "description": "Meter number",
      "type": "string"
    },
    "MeasuringPointName": {
      "description": "Measurement identifier in the system",
      "type": "string"
    },
    "AvailableFlexibilities": {
      "description": "List of available flexibilities (PV, WP, EV, BESS)",
      "type": "array",
      "items": {
        "type": "string",
        "enum": [ "PV", "WP", "EV", "BESS" ]
      }
    },
    "PVSize": {
      "description": "PV plant size (DC side) in [kWp]",
      "type": "number"
    },
    "BatteryCapacity": {
      "description": "Battery Capacity in [kWh]",
      "type": "number"
    },
    "HeatpumpPower": {
      "description": "Electrical power of heat pump in [kW]",
      "type": "number"
    },
    "WriteAccess": {
      "description": "Customer grants write access to DSO",
      "type": "boolean"
    },
    "PVControl": {
      "description": "is PV restriction available yes or no",
      "type": "boolean"
    }
  },
  "required": [
    "Address", "MeterNumber", "MeasuringPointName", "AvailableFlexibilities",
    "PVSize", "BatteryCapacity", "HeatpumpPower", "WriteAccess", "PVControl"
  ]
}
</pre></font>

JSON example:

<font size="1"><pre style="color:blue">
{
  "Address": {
    "Street": "string",
    "ZipCode": "string",
    "City": "string"
  },
  "MeterNumber": "string",
  "MeasuringPointName": "string",
  "AvailableFlexibilities": [
    "PV"
  ],
  "PVSize": 0,
  "BatteryCapacity": 0,
  "HeatpumpPower": 0,
  "WriteAccess": true,
  "PVControl": true
}
</pre></font>
            ]]>
          </textElement>
          <language>en</language>
        </legibleDescription>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Lesen der statischen Installationsdaten wie Adresse, Zählernummer und installierte Flexibilitäten.</p>

Schema des gelieferten JSON-Objekts:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Einstellungen",
  "description": "Aktuelle Einstellungen",
  "type": "object",
  "properties": {
    "Address": {
      "description": "Adresse des Energiemanagers",
      "type": "object",
      "properties": {
        "Street": {
          "description": "Strasse und Hausnummer",
          "type": "string"
        },
        "ZipCode": {
          "description": "Postleitzahl",
          "type": "string",
        },
        "City": {
          "description": "Ort",
          "type": "string"
        }
      },
      "required": [
        "Street", "ZipCode", "City"
      ]
    },
    "MeterNumber": {
      "description": "Nummer auf dem Zähler",
      "type": "string"
    },
    "MeasuringPointName": {
      "description": "Messpunktbezeichnung im System",
      "type": "string"
    },
    "AvailableFlexibilities": {
      "description": "Liste der vorhandenen Flexibilitäten (PV, WP, EV, BESS)",
      "type": "array",
      "items": {
        "type": "string",
        "enum": [ "PV", "WP", "EV", "BESS" ]
      }
    },
    "PVSize": {
      "description": "Grösse PV Anlage (DC seitig) in [kWp]",
      "type": "number"
    },
    "BatteryCapacity": {
      "description": "Battery Capacity in [kWh]",
      "type": "number"
    },
    "HeatpumpPower": {
      "description": "Leistung Wärmepumpe elektrisch in [kW]",
      "type": "number"
    },
    "WriteAccess": {
      "description": "Kunde gibt Schreibzugriff auf Anlage an VNB",
      "type": "boolean"
    },
    "PVControl": {
      "description": "ist PV Reduzierung verfügbar ja oder nein",
      "type": "boolean"
    }
  },
  "required": [
    "Address", "MeterNumber", "MeasuringPointName", "AvailableFlexibilities",
    "PVSize", "BatteryCapacity", "HeatpumpPower", "WriteAccess", "PVControl"
  ]
}
</pre></font>

JSON-Beispiel:

<font size="1"><pre style="color:blue">
{
  "Address": {
    "Street": "string",
    "ZipCode": "string",
    "City": "string"
  },
  "MeterNumber": "string",
  "MeasuringPointName": "string",
  "AvailableFlexibilities": [
    "PV"
  ],
  "PVSize": 0,
  "BatteryCapacity": 0,
  "HeatpumpPower": 0,
  "WriteAccess": true,
  "PVControl": true
}
</pre></font>
            ]]>
          </textElement>
          <language>de</language>
        </legibleDescription>
      </dataPoint>
    </dataPointListElement>
    <dataPointListElement>
      <dataPoint>
        <dataPointName>GetData</dataPointName>
        <dataDirection>R</dataDirection>
        <presenceLevel>R</presenceLevel>
        <dataType>
          <json />
        </dataType>
        <unit>NONE</unit>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Reading dynamic information, such as current PV production or power at the grid connection point.</p>

Schema of the returned JSON object:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Data",
  "description": "Current data and flexibilities",
  "type": "object",
  "properties": {
    "EmsAvailable": {
      "description": "Status of the EMS",
      "type": "string",
      "enum": [ "EMS_REACHABLE", "EMS_NOT_REACHABLE", "EMS_CONNECTION_FAULT" ]
    },
    "PVPower": {
      "description": "Current power of production in [kW]",
      "type": "number"
    },
    "MeterPower": {
      "description": "Current power at balance meter (+ consumption, - feed-In) in [kW]",
      "type": "number"
    },
    "AvailableFlexPositive": {
      "description": "Available positive flexibility (consumption) in [kW]",
      "type": "number"
    },
    "AvailableFlexNegative": {
      "description": "Available negative flexibility (production) in [kW]",
      "type": "number"
    },
    "BESSSoc": {
      "description": "Current state of charge of storage in [%]",
      "type": "integer"
    },
    "BESSCapacityNegative": {
      "description": "Charging capacity up to limit in [kWh]",
      "type": "number"
    },
    "BESSCapacityPositive": {
      "description": "Discharging capacity down to limit in [kWh]",
      "type": "number"
    },
    "MeterVoltage": {
      "description": "Feedback of voltage levels at building connection point in [V]",
      "type": "object",
      "properties": {
        "Voltage1": {
          "description": "Voltage of phase 1 in [V]",
          "type": "number"
        },
        "Voltage2": {
          "description": "Voltage of phase 2 in [V]",
          "type": "number"
        },
        "Voltage3": {
          "description": "Voltage of phase 3 in [V]",
          "type": "number"
        }
      },
      "required": [
        "Voltage1", "Voltage2", "Voltage3"
      ]
    }
  },
  "required": [
    "EmsAvailable", "PVPower", "MeterPower", "BESSSoc", "MeterVoltage"
  ]
}
</pre></font>

JSON example:

<font size="1"><pre style="color:blue">
{
  "EmsAvailable": "EMS_REACHABLE",
  "PVPower": 0,
  "MeterPower": 0,
  "AvailableFlexPositive": 0,
  "AvailableFlexNegative": 0,
  "BESSSoc": 0,
  "BESSCapacityNegative": 0,
  "BESSCapacityPositive": 0,
  "MeterVoltage": {
    "Voltage1": 0,
    "Voltage2": 0,
    "Voltage3": 0
  }
}
</pre></font>
            ]]>
          </textElement>
          <language>en</language>
        </legibleDescription>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Lesen der dynamischen Informationen, beispielsweise die aktuelle PV-Produktion oder die Leistung am Netzanschlusspunkt.</p>

Schema des gelieferten JSON-Objekts:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Daten",
  "description": "Aktuelle Daten und Flexibilitäten",
  "type": "object",
  "properties": {
    "EmsAvailable": {
      "description": "Zustand des EMS",
      "type": "string",
      "enum": [ "EMS_REACHABLE", "EMS_NOT_REACHABLE", "EMS_CONNECTION_FAULT" ]
    },
    "PVPower": {
      "description": "Aktuelle Produktionsleistung in [kW]",
      "type": "number"
    },
    "MeterPower": {
      "description": "Aktuelle Leistung am Bilanzzähler (+ Bezug, - Feed-In) in [kW]",
      "type": "number"
    },
    "AvailableFlexPositive": {
      "description": "verfügbare Flexibilität positiv (Bezug) in [kW]",
      "type": "number"
    },
    "AvailableFlexNegative": {
      "description": "verfügbare Flexibilität negativ (Produktion) in [kW]",
      "type": "number"
    },
    "BESSSoc": {
      "description": "Aktueller Ladestand Speicher in [%]",
      "type": "integer"
    },
    "BESSCapacityNegative": {
      "description": "mögliche Kapazität zum Laden bis Limite in [kWh]",
      "type": "number"
    },
    "BESSCapacityPositive": {
      "description": "mögliche Kapazität zum Entladen bis Limite in [kWh]",
      "type": "number"
    },
    "MeterVoltage": {
      "description": "Feedback aller Spannungslevel am Hausanschluss in [V]",
      "type": "object",
      "properties": {
        "Voltage1": {
          "description": "Spannung Phase 1 in [V]",
          "type": "number"
        },
        "Voltage2": {
          "description": "Spannung Phase 2 in [V]",
          "type": "number"
        },
        "Voltage3": {
          "description": "Spannung Phase 3 in [V]",
          "type": "number"
        }
      },
      "required": [
        "Voltage1", "Voltage2", "Voltage3"
      ]
    }
  },
  "required": [
    "EmsAvailable", "PVPower", "MeterPower", "BESSSoc", "MeterVoltage"
  ]
}
</pre></font>

JSON-Beispiel:

<font size="1"><pre style="color:blue">
{
  "EmsAvailable": "EMS_REACHABLE",
  "PVPower": 0,
  "MeterPower": 0,
  "AvailableFlexPositive": 0,
  "AvailableFlexNegative": 0,
  "BESSSoc": 0,
  "BESSCapacityNegative": 0,
  "BESSCapacityPositive": 0,
  "MeterVoltage": {
    "Voltage1": 0,
    "Voltage2": 0,
    "Voltage3": 0
  }
}
</pre></font>
            ]]>
          </textElement>
          <language>de</language>
        </legibleDescription>
      </dataPoint>
    </dataPointListElement>
    <dataPointListElement>
      <dataPoint>
        <dataPointName>RestrictPower</dataPointName>
        <dataDirection>W</dataDirection>
        <presenceLevel>R</presenceLevel>
        <dataType>
          <json />
        </dataType>
        <unit>NONE</unit>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Setting a time-limited restriction for the allowed power range at the grid connection point. Both a minimum and a maximum value can be set (positive values for consumption, negative for feed-in).</p>
<p>Examples:</p>
<ul>
  <li>Feed-in limited to 0, no restriction on consumption:<br>MinimumPowerKw = 0, MaximumPowerKw = 100</li>
  <li>Allowed range: max. 10 kW feed-in, max. 5 kW consumption:<br>MinimumPowerKw = -100, MaximumPowerKw = 5</li>
</ul>

Schema of the JSON object to be sent:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Restrict Power",
  "description": "Set power restriction",
  "type": "object",
  "properties": {
    "RestrictionActive": {
      "description": "Activation of power restriction",
      "type": "boolean"
    },
    "Restriction": {
      "description": "Power restriction",
      "type": "object",
      "properties": {
        "MinimumPowerKw": {
          "description": "Minimum power (+ consumption, - feed-In) in [kW]",
          "type": "number"
        },
        "MaximumPowerKw": {
          "description": "Maximum power (+ consumption, - feed-In) in [kW]",
          "type": "number"
        },
        "DurationInMinutes": {
          "description": "Duration in [min]",
          "type": "integer"
        }
      },
      "required": [
        "MinimumPowerKw", "MaximumPowerKw", "DurationInMinutes"
      ]
    }
  },
  "required": [
    "RestrictionActive", "Restriction"
  ]
}
</pre></font>

JSON example:

<font size="1"><pre style="color:blue">
{
  "RestrictionActive": true,
  "Restriction": {
    "MinimumPowerKw": -2,
    "MaximumPowerKw": 8,
    "DurationInMinutes": 30
  }
}
</pre></font>
            ]]>
          </textElement>
          <language>en</language>
        </legibleDescription>
        <legibleDescription>
          <textElement>
            <![CDATA[
<p>Setzen einer zeitlich begrenzten Einschränkung für den zulässigen Leistungsbereich am Netzanschlusspunkt. Es können sowohl ein Minimal- als auch ein Maximalwert gesetzt werden (positive Werte für Bezug, negative für Einspeisung).</p>
<p>Beispiele:</p>
<ul>
  <li>Einspeisung auf 0 begrenzt, keine Einschränkung beim Bezug:<br>MinimumPowerKw = 0, MaximumPowerKw = 100</li>
  <li>Zulässiger Bereich: max. 10 kW Einspeisung, max. 5 kW Bezug:<br>MinimumPowerKw = -10, MaximumPowerKw = 5</li>
</ul>

Schema des zu übergebenden JSON-Objekts:

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Einschränkungen für die Leistung",
  "description": "Einschränkungen einstellen",
  "type": "object",
  "properties": {
    "RestrictionActive": {
      "description": "Aktivierung der Leistungsreduktion",
      "type": "boolean"
    },
    "Restriction": {
      "description": "Leistungsreduktion",
      "type": "object",
      "properties": {
        "MinimumPowerKw": {
          "description": "Minimale Leistung (+ Bezug, - Feed-In) in [kW]",
          "type": "number"
        },
        "MaximumPowerKw": {
          "description": "Maximale Leistung (+ Bezug, - Feed-In) in [kW]",
          "type": "number"
        },
        "DurationInMinutes": {
          "description": "Dauer in [min]",
          "type": "integer"
        }
      },
      "required": [
        "MinimumPowerKw", "MaximumPowerKw", "DurationInMinutes"
      ]
    }
  },
  "required": [
    "RestrictionActive", "Restriction"
  ]
}
</pre></font>

JSON-Beispiel:

<font size="1"><pre style="color:blue">
{
  "RestrictionActive": true,
  "Restriction": {
    "MinimumPowerKw": -2,
    "MaximumPowerKw": 8,
    "DurationInMinutes": 30
  }
}
</pre></font>
            ]]>
          </textElement>
          <language>de</language>
        </legibleDescription>
      </dataPoint>
    </dataPointListElement>
  </dataPointList>
</FunctionalProfileFrame>
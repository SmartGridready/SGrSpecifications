<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/SGr.xsl"?>
<RestApiDeviceFrame xmlns="http://www.smartgridready.com/ns/V0/"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.smartgridready.com/ns/V0/ ../../SchemaDatabase/SGr/Product/RestApiFrame.xsd
                      ">
  <!-- TODO: broken XML, this EI needs fixing... -->
  <deviceName>Smart Charge Controller</deviceName>
  <manufacturerName>A. Lehmann Elektro AG</manufacturerName>
  <specificationOwnerIdentification>0</specificationOwnerIdentification>
  <releaseNotes>
    <state>Draft</state>
  </releaseNotes>
  <deviceInformation>
    <transportService>RESTfulJSON</transportService>
    <deviceCategory>SubMeterElectricity</deviceCategory>
    <isLocalControl>true</isLocalControl>
    <softwareRevision>0.0.0</softwareRevision>
  </deviceInformation>
  <restApiInterfaceDescription>
    <restApiInterfaceSelection>URI</restApiInterfaceSelection>
    <restApiUri>https://api.smartchargecontroller.ch:3000</restApiUri>
    <restApiAuthenticationMethod>BearerSecurityScheme</restApiAuthenticationMethod>
    <restApiBearer>
      <restApiServiceCall>
        <requestHeader>
          <header>
            <headerName>Accept</headerName>
            <value>application/json</value>
          </header>
        </requestHeader>
        <requestMethod>POST</requestMethod>
        <requestPath>/auth/login</requestPath>
        <requestBody>{"username": "{{username}}", "password": "{{password}}" }</requestBody>
        <responseQuery>
          <queryType>JMESPathExpression</queryType>
          <query>accessToken</query>
        </responseQuery>
      </restApiServiceCall>
    </restApiBearer>
  </restApiInterfaceDescription>
  <functionalProfileList>
    <functionalProfileListElement>
      <functionalProfile>
        <functionalProfileName>ActivePowerAC</functionalProfileName>
        <functionalProfileIdentification>
          <specificationOwnerIdentification>0</specificationOwnerIdentification>
          <functionalProfileCategory>NonSpecific</functionalProfileCategory>
          <functionalProfileType>ActivePowerAC</functionalProfileType>
          <levelOfOperation>m</levelOfOperation>
          <versionNumber>
            <primaryVersionNumber>1</primaryVersionNumber>
            <secondaryVersionNumber>0</secondaryVersionNumber>
            <subReleaseVersionNumber>0</subReleaseVersionNumber>
          </versionNumber>
        </functionalProfileIdentification>
      </functionalProfile>
      <dataPointList>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>ActivePowerACtot</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>WATTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>sum([activePower.l1,activePower.l2,activePower.l3])</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>ActivePowerACL1</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>WATTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>activePower.l1</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>ActivePowerACL2</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>WATTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>activePower.l2</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>ActivePowerACL3</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>WATTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>activePower.l3</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
      </dataPointList>
    </functionalProfileListElement>
    <functionalProfileListElement>
      <functionalProfile>
        <functionalProfileName>VoltageAC</functionalProfileName>
        <functionalProfileIdentification>
          <specificationOwnerIdentification>0</specificationOwnerIdentification>
          <functionalProfileCategory>NonSpecific</functionalProfileCategory>
          <functionalProfileType>VoltageAC</functionalProfileType>
          <levelOfOperation>4</levelOfOperation>
          <versionNumber>
            <primaryVersionNumber>0</primaryVersionNumber>
            <secondaryVersionNumber>1</secondaryVersionNumber>
            <subReleaseVersionNumber>1</subReleaseVersionNumber>
          </versionNumber>
        </functionalProfileIdentification>
      </functionalProfile>
      <dataPointList>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>VoltageACL1_N</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>VOLTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>voltage.l1</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>VoltageACL2_N</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>VOLTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>voltage.l2</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>VoltageACL3_N</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>VOLTS</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>voltage.l3</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
      </dataPointList>
    </functionalProfileListElement>
    <functionalProfileListElement>
      <functionalProfile>
        <functionalProfileName>CurrentAC</functionalProfileName>
        <functionalProfileIdentification>
          <specificationOwnerIdentification>0</specificationOwnerIdentification>
          <functionalProfileCategory>NonSpecific</functionalProfileCategory>
          <functionalProfileType>CurrentAC</functionalProfileType>
          <levelOfOperation>m</levelOfOperation>
          <versionNumber>
            <primaryVersionNumber>1</primaryVersionNumber>
            <secondaryVersionNumber>0</secondaryVersionNumber>
            <subReleaseVersionNumber>0</subReleaseVersionNumber>
          </versionNumber>
        </functionalProfileIdentification>
      </functionalProfile>
      <dataPointList>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>CurrentACL1</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>M</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>AMPERES</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>current.l1</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>CurrentACL2</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>AMPERES</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>current.l2</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
        <dataPointListElement>
          <dataPoint>
            <dataPointName>CurrentACL3</dataPointName>
            <dataDirection>R</dataDirection>
            <presenceLevel>R</presenceLevel>
            <dataType>
              <float64 />
            </dataType>
            <unit>AMPERES</unit>
          </dataPoint>
          <genericAttributes>
            <measuredValueSource>measuredValue</measuredValueSource>
            <sampleRateHz>10</sampleRateHz>
          </genericAttributes>
          <restApiDataPointConfiguration>
            <dataType>JSON_number</dataType>
            <restApiServiceCall>
              <requestHeader>
                <header>
                  <headerName>Accept</headerName>
                  <value>application/json</value>
                </header>
              </requestHeader>
              <requestMethod>GET</requestMethod>
              <requestPath>/edges/{{edgeid}}/metrics/momentaryMeterValues</requestPath>
              <responseQuery>
                <queryType>JMESPathExpression</queryType>
                <query>current.l3</query>
              </responseQuery>
            </restApiServiceCall>
          </restApiDataPointConfiguration>
        </dataPointListElement>
      </dataPointList>
    </functionalProfileListElement>
  </functionalProfileList>
</RestApiDeviceFrame>
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/SGr.xsl"?>
<DeviceFrame xmlns="http://www.smartgridready.com/ns/V0/"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.smartgridready.com/ns/V0/ ../../SchemaDatabase/SGr/Product/Product.xsd">
  <deviceName>Gantrisch gPlug MQTT VSE Bi-Directional</deviceName>
  <manufacturerName>Gantrisch Energie AG</manufacturerName>
  <specificationOwnerIdentification>0</specificationOwnerIdentification>
  <releaseNotes>
    <state>Draft</state>
    <changeLog>
      <version>0.1.0</version>
      <date>2025-01-17</date>
      <author>SGr/mkr</author>
      <comment>Draft for Testlab</comment>
    </changeLog>
    <changeLog>
      <version>0.2.0</version>
      <date>2025-05-20</date>
      <author>SGr/mkr</author>
      <comment>Use bidir. FP</comment>
    </changeLog>
  </releaseNotes>
  <deviceInformation>
    <legibleDescription>
      <textElement>
        <![CDATA[
          <p>Diese EID unterstützt die komplette VSE-Kundenschnittstelle via gPlug D/K/M von Gantrisch Energie.</p>
          <p>Folgende Konfigurationsvorgaben müssen erfüllt sein:</p>
          <p>
            <b>MQTT:</b><br />
            <ul>
              <li>Topic Path = <pre>%prefix%/%topic%/</pre></li>
            </ul>
          </p>
          <p>
            <b>Tasmota Skript:</b><br />
            <ul>
              <li>Telemetrie-Intervall (komplette Daten) = 10 s</li>
              <li>Telemetrie (Momentanwerte) deaktiviert</li>
              <li>Name des Telemetrie-Datenfelds = "gPlug"</li>
            </ul>
          </p>
          <p>
            Folgende Telemetrie-Keys müssen konfiguriert werden (OBIS Code als Referenz):
            <ul>
              <li>Pi = 1.7.0</li>
              <li>Po = 2.7.0</li>
              <li>P1i = 21.7.0</li>
              <li>P2i = 41.7.0</li>
              <li>P3i = 61.7.0</li>
              <li>P1o = 22.7.0</li>
              <li>P2o = 42.7.0</li>
              <li>P3o = 62.7.0</li>
              <li>Ei = 1.8.0</li>
              <li>Eo = 2.8.0</li>
              <li>V1 = 32.7.0</li>
              <li>V2 = 52.7.0</li>
              <li>V3 = 72.7.0</li>
              <li>I1 = 31.7.0</li>
              <li>I2 = 51.7.0</li>
              <li>I3 = 71.7.0</li>
            </ul>
          </p>
          <p>
            Als "topic_path" muss der gesamte Topic-Pfad inkl. Präfix eingegeben werden, z.B. <pre>tele/gPlugD_021345/SENSOR</pre>.
            Das Telegramm ist immer "SENSOR" und muss alle Messwerte enthalten.
          </p>
        ]]>
      </textElement>
      <language>de</language>
      <uri>https://gplug.ch/produkte/</uri>
    </legibleDescription>
    <deviceCategory>SubMeterElectricity</deviceCategory>
    <isLocalControl>false</isLocalControl>
    <softwareRevision>14.0.0</softwareRevision>
    <hardwareRevision>1.0.0</hardwareRevision>
    <manufacturerSpecificationIdentification>Gantrisch</manufacturerSpecificationIdentification>
    <levelOfOperation>m</levelOfOperation>
    <versionNumber>
      <primaryVersionNumber>0</primaryVersionNumber>
      <secondaryVersionNumber>2</secondaryVersionNumber>
      <subReleaseVersionNumber>0</subReleaseVersionNumber>
    </versionNumber>
    <testState>None</testState>
  </deviceInformation>
  <configurationList>
    <configurationListElement>
      <name>broker_host</name>
      <dataType>
        <string />
      </dataType>
      <defaultValue>localhost</defaultValue>
      <configurationDescription>
        <textElement>Message broker hostname or IP address.</textElement>
        <language>en</language>
        <label>Broker Hostname</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker Hostname oder IP-Adresse.</textElement>
        <language>de</language>
        <label>Broker-Hostname</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>broker_port</name>
      <dataType>
        <int32 />
      </dataType>
      <defaultValue>1883</defaultValue>
      <configurationDescription>
        <textElement>Message broker TCP port.</textElement>
        <language>en</language>
        <label>Broker Port</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker TCP-Port.</textElement>
        <language>de</language>
        <label>Broker-Port</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>broker_tls</name>
      <dataType>
        <boolean />
      </dataType>
      <defaultValue>false</defaultValue>
      <configurationDescription>
        <textElement>Message broker TLS.</textElement>
        <language>en</language>
        <label>Broker TLS</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker TLS.</textElement>
        <language>de</language>
        <label>Broker-TLS</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>broker_tls_verify</name>
      <dataType>
        <boolean />
      </dataType>
      <defaultValue>false</defaultValue>
      <configurationDescription>
        <textElement>Message broker TLS certificate verification.</textElement>
        <language>en</language>
        <label>Broker TLS Verification</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker TLS Zertifikatsprüfung.</textElement>
        <language>de</language>
        <label>Broker-TLS-Verifizierung</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>broker_username</name>
      <dataType>
        <string />
      </dataType>
      <defaultValue></defaultValue>
      <configurationDescription>
        <textElement>Message broker user name.</textElement>
        <language>en</language>
        <label>Broker User</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker User-Name.</textElement>
        <language>de</language>
        <label>Broker-User</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>broker_password</name>
      <dataType>
        <string />
      </dataType>
      <defaultValue></defaultValue>
      <configurationDescription>
        <textElement>Message broker password.</textElement>
        <language>en</language>
        <label>Broker Password</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Message-Broker Passwort.</textElement>
        <language>de</language>
        <label>Broker-Passwort</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>topic_path</name>
      <dataType>
        <string />
      </dataType>
      <defaultValue>tele/gPlug_012345/SENSOR</defaultValue>
      <configurationDescription>
        <textElement>MQTT topic path.</textElement>
        <language>en</language>
        <label>Topic Path</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>MQTT-Topic-Pfad.</textElement>
        <language>de</language>
        <label>Topic-Pfad</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>field_name</name>
      <dataType>
        <string />
      </dataType>
      <defaultValue>gPlug</defaultValue>
      <configurationDescription>
        <textElement>JSON field name containing data</textElement>
        <language>en</language>
        <label>JSON field name</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>JSON-Feldname mit Daten</textElement>
        <language>de</language>
        <label>JSON-Feldname</label>
      </configurationDescription>
    </configurationListElement>
  </configurationList>
  <interfaceList>
    <messagingInterface>
      <messagingInterfaceDescription>
        <platform>MQTT5</platform>
        <messageBrokerList>
          <messageBrokerListElement>
            <host>{{broker_host}}</host>
            <port>{{broker_port}}</port>
            <tls>{{broker_tls}}</tls>
            <tlsVerifyCertificate>{{broker_tls_verify}}</tlsVerifyCertificate>
          </messageBrokerListElement>
        </messageBrokerList>
        <messageBrokerAuthentication>
          <basicAuthentication>
            <username>{{broker_username}}</username>
            <password>{{broker_password}}</password>
          </basicAuthentication>
        </messageBrokerAuthentication>
      </messagingInterfaceDescription>
      <functionalProfileList>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>SmartmeterId</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>DeviceInformation</functionalProfileCategory>
              <functionalProfileType>DeviceInformation</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>1</primaryVersionNumber>
                <secondaryVersionNumber>0</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <p>Functional profile used to read a device ID used to identify a device.</p>
                  <p>Further on, this functional profile that can be used for vendor specific information and data points.
                  It allows the handling of data points, which are valid for the whole device.</p>
                ]]>
              </textElement>
              <language>en</language>
            </legibleDescription>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <p>Funktionsprofil zum Auslesen einer Geräte ID zur Identifikation des Geräts.</p>
                  <p>Weiterhin kann das Funktionsprofil für herstellerspezifische Informationen und Datenpunkte benutzt werden.
                  Es ermöglicht das Handling von Datenpunkten, welche für das ganze Gerät gelten.</p>
                ]]>
              </textElement>
              <language>de</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>DeviceId</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <string />
                </dataType>
                <unit>NONE</unit>
                <alternativeNames>
                  <manufName>96.1.1</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>The device ID</textElement>
                  <language>en</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Die Geräte-ID</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <string />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".SMid</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>ActivePowerAC</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>Metering</functionalProfileCategory>
              <functionalProfileType>ActivePowerACBiDir</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>0</primaryVersionNumber>
                <secondaryVersionNumber>1</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Messung der Wirkleistung</strong><br>
                  Monitoring Funktionsprofil für Stromerzeuger und Stromverbraucher zur bidirektionalen Messung der Wirkleistung.

                  <p>Dieses Funktionsprofil erlaubt sowohl die Messung der Totalleistung wie auch die Leistung der drei
                    einzelnen Phasen. Eine der folgenden Varianten muss bei der Implementierung des Funktionsprofiles
                    umgesetzt werden:
                  <ul>
                    <li>Einphasige Geräte geben die Totalleistung an (ActivePowerACtot)</li>
                    <li>3-phasige Geräte ohne Totalleistungsmessung geben die Leistung pro Phase an (ActivePowerACL1, ActivePowerACL2, ActivePowerACL3)</li>
                    <li>3-phasige Geräte mit Einzelphasen- und Totalleistungsmessung geben alle Datenpunkte an</li>
                  </ul>
                  </p>

                  <p>Angaben, die für die Konfiguration der Schnittstelle oder für den Aufbau von Use-Cases zur Steuerung nötig sind können während der Deklaration
                    für das gesamte Gerät oder für einzelne Datenpunkte angegeben werden
                    (siehe <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generische Attribute</a>).
                ]]>
              </textElement>
              <language>de</language>
            </legibleDescription>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Active Power Measurement</strong><br>
                  Monitoring functional profile for power generators and consumers for reflecting the bidirectional measurement of active power.

                  <p>With this functional profile you can measure the total active power as well as the active power of
                    the three individual phases. One of the following options must be implemented for fulfilling the functional profile:
                  <ul>
                    <li>Single-phase devices use the total active power data point (ActivePowerACtot)</li>
                    <li>Three-phase devices without measurement of the total active power use the data points per phase (ActivePowerACL1, ActivePowerACL2, ActivePowerACL3)</li>
                    <li>Three-phase devices with measurement of the total active power use all data points</li>
                  </ul>
                  </p>

                  <p>Information necessary for configuring the interface or for defining use cases to the control the device can be specified during the declaration
                    either for the entire device or for individual datapoints
                    (see <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generic Attributes</a>).
                    </p>
                ]]>
              </textElement>
              <language>en</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACtot.Import</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>1.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der gesamten Wirkleistung (Bezug)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Total active power measurement (import)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".Pi</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL1.Import</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>21.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 1 (Bezug)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 1 (import)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P1i</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL2.Import</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>41.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 2 (Bezug)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 2 (import)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P2i</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL3.Import</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>61.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 3 (Bezug)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 3 (import)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P3i</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACtot.Export</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>2.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der gesamten Wirkleistung (Einspeisung)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Total active power measurement (export)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".Po</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL1.Export</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>22.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 1 (Einspeisung)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 1 (export)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P1o</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL2.Export</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>42.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 2 (Einspeisung)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 2 (export)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P2o</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActivePowerACL3.Export</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>62.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Wirkleistung Phase 3 (Einspeisung)</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Active power measurement of phase 3 (export)</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".P3o</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>ActiveEnergyAC</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>Metering</functionalProfileCategory>
              <functionalProfileType>ActiveEnergyACBiDir</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>0</primaryVersionNumber>
                <secondaryVersionNumber>1</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Energy measurement</strong><br>
                  Monitoring functional profile for power generators and consumers for reflecting the bi-directional active energy measurement.

                  <p>Data is typically recorded by an energy manager (or a billing software).</p>

                  <p>With this functional profile you can measure the total energy as well as the energy of the three
                    individual phases. One of the following options must be implemented for fulfilling the functional profile:
                  <ul>
                    <li>Single-phase devices use the total energy data point (ActiveEnergyACtot)</li>
                    <li>Three-phase devices without measurement of the total energy use the data points per (ActiveEnergyACL1, ActiveEnergyACL2, ActiveEnergyACL3)</li>
                    <li>Three-phase devices with measurement of the total energy all data points</li>
                  </ul>
                  </p>

                  <p>Information necessary for configuring the interface or for defining use cases to the control the device can be specified during the declaration
                    either for the entire device or for individual datapoints
                    (see <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generic Attributes</a>).
                    </p>
                ]]>
              </textElement>
              <language>en</language>
            </legibleDescription>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Messung der Wirkenergie</strong><br>
                  Monitoring Funktionsprofil für Stromerzeuger und Stromverbraucher zur bidirektionalen Messung der Wirkenergie.

                  <p>Die Datenaufnahme erfolgt typischerweise durch einen Energiemanager (oder eine Abrechnungssoftware).</p>

                  <p>Dieses Funktionsprofil erlaubt sowohl die Messung der Gesamtenergie wie auch die Messung der Energie
                    der drei einzelnen Phasen. Eine der folgenden Varianten muss bei der Implementierung des Funktionsprofiles
                    umgesetzt werden:
                  <ul>
                    <li>1-phasige Geräte geben die Gesamtenergie an (ActiveEnergyACtot)</li>
                    <li>3-phasige Geräte ohne Gesamtenergiemessung geben die Energiemenge pro Phase an (ActiveEnergyACL1, ActiveEnergyACL2, ActiveEnergyACL3)</li>
                    <li>3-phasige Geräte mit Einzelphasen- und Gesamtenergiemessung geben alle Datenpunkte an</li>
                  </ul>
                  </p>

                  <p>Angaben, die für die Konfiguration der Schnittstelle oder für den Aufbau von Use-Cases zur Steuerung nötig sind können während der Deklaration
                    für das gesamte Gerät oder für einzelne Datenpunkte angegeben werden
                    (siehe <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generische Attribute</a>).
                ]]>
              </textElement>
              <language>de</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActiveEnergyACtot.Import</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATT_HOURS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>1.8.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Total energy measurement (import)</textElement>
                  <language>en</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Erfassung der gesamten Wirkenergie (Bezug)</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".Ei</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>ActiveEnergyACtot.Export</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>KILOWATT_HOURS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>2.8.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Total energy measurement (export)</textElement>
                  <language>en</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Erfassung der gesamten Wirkenergie (Einspeisung)</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".Eo</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>VoltageAC</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>Metering</functionalProfileCategory>
              <functionalProfileType>VoltageAC</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>1</primaryVersionNumber>
                <secondaryVersionNumber>0</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Messung der Spannung</strong><br />
                  Monitoring Funktionsprofil für Stromerzeuger und Stromverbraucher zur Kontrolle der Systemlast und/oder für regeltechnische
                  Zwecke.

                  <p>Dieses Funktionsprofil erlaubt sowohl die Messung der Spannung auf einer Phase wie auch auf drei Phasen.
                    Eine der folgenden Varianten muss bei der Implementierung des Funktionsprofiles umgesetzt werden:
                  <ul>
                    <li>Einphasige Geräte geben die Spannung über die erste Phase an (VoltageACL1_N)</li>
                    <li>3-phasige Geräte in Sternschaltung geben die Spannung pro Phase gegen den Nullleiter an (VoltageACL1_N, VoltageACL2_N, VoltageACL2_N).</li>
                    <li>3-phasige Geräte in Dreiecksschaltung geben die Spannung zwischen den Phasen an (VoltageACL1_L2, VoltageACL1_L3, VoltageACL2_L3).</li>
                  </ul>
                  </p>

                  <p>Angaben, die für die Konfiguration der Schnittstelle oder für den Aufbau von Use-Cases zur Steuerung nötig sind können während der Deklaration
                    für das gesamte Gerät oder für einzelne Datenpunkte angegeben werden
                    (siehe <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generische Attribute</a>).
                  </p>
                ]]>
              </textElement>
              <language>de</language>
            </legibleDescription>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <img src="ressources/fp_product_to_cem.svg" style="float:left; padding:0.3em;"/>
                  <strong>Voltage measurement</strong><br />
                  Monitoring functional profile for power generators and consumers for reflecting the voltage.

                  <p>This functional profile allows measurement of the voltage on a single phase of three phases.
                    One of the following approaches must be applied when implementing the functional profile:
                  <ul>
                    <li>Single-phase devices use the total voltage with the first data point (VoltageACL1_N)</li>
                    <li>Three-phase devices in star configuration provide the voltage per phase vs. neutral using three data points (VoltageACL1_N, VoltageACL2_N, VoltageACL3_N).</li>
                    <li>Three-phase devices in delta configuration provide the voltage between phases using three data points (VoltageACL1_L2, VoltageACL1_L3, VoltageACL2_L3).</li>
                  </ul>
                  </p>

                  <p>Information necessary for configuring the interface or for defining use cases to the control the device can be specified during the declaration
                    either for the entire device or for individual datapoints
                    (see <a href="https://github.com/SmartGridready/SGrSpecifications/blob/master/doc/GenericAttributes.md#static-data-point-attributes">Generic Attributes</a>).
                  </p>
                ]]>
              </textElement>
              <language>en</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>VoltageACL1_N</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>VOLTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>32.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Spannung zwischen Phase 1 und Nullleiter</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Measurement of the voltage between phase 1 and neutral</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".V1</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>VoltageACL2_N</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>VOLTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>52.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Spannung zwischen Phase 2 und Nullleiter</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Measurement of the voltage between phase 2 and neutral</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".V2</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>VoltageACL3_N</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>VOLTS</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>72.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Erfassung der Spannung zwischen Phase 3 und Nullleiter</textElement>
                  <language>de</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>Measurement of the voltage between phase 3 and neutral</textElement>
                  <language>en</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".V3</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>CurrentAC</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>Metering</functionalProfileCategory>
              <functionalProfileType>CurrentAC</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>1</primaryVersionNumber>
                <secondaryVersionNumber>0</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                Messung des aktuellen Stromflusses.
              </textElement>
              <language>de</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>CurrentACL1</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>AMPERES</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>31.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Stromfluss Phase 1</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".I1</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>CurrentACL2</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>AMPERES</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>51.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Stromfluss Phase 2</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".I2</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>CurrentACL3</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <float64 />
                </dataType>
                <unit>AMPERES</unit>
                <minimumValue>0</minimumValue>
                <alternativeNames>
                  <manufName>71.7.0</manufName>
                </alternativeNames>
                <legibleDescription>
                  <textElement>Stromfluss Phase 3</textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <messagingDataPointConfiguration>
                <messagingDataType>
                  <number />
                </messagingDataType>
                <inMessage>
                  <topic>{{topic_path}}</topic>
                  <filter>
                    <jmespathFilter>
                      <query>"{{field_name}}"</query>
                      <matchesRegex>\{.*\}</matchesRegex>
                    </jmespathFilter>
                  </filter>
                  <responseQuery>
                    <queryType>JMESPathExpression</queryType>
                    <query>"{{field_name}}".I3</query>
                  </responseQuery>
                </inMessage>
              </messagingDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
      </functionalProfileList>
    </messagingInterface>
  </interfaceList>
</DeviceFrame>
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/SGr.xsl"?>
<DeviceFrame xmlns="http://www.smartgridready.com/ns/V0/"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.smartgridready.com/ns/V0/ ../../SchemaDatabase/SGr/Product/Product.xsd">
  <deviceName>EKZ Dynamic Tariffs</deviceName>
  <manufacturerName>EKZ</manufacturerName>
  <specificationOwnerIdentification>0</specificationOwnerIdentification>
  <releaseNotes>
    <state>Draft</state>
    <changeLog>
      <version>0.1.0</version>
      <date>2025-10-13</date>
      <author>SGr/mkr</author>
      <comment>Initial draft</comment>
    </changeLog>
    <changeLog>
      <version>0.2.0</version>
      <date>2026-02-04</date>
      <author>SGr/mkr</author>
      <comment>Draft based on VSE</comment>
    </changeLog>
  </releaseNotes>
  <deviceInformation>
    <legibleDescription>
      <textElement>
        <![CDATA[
          <p>EKZ's dynamic tariff consists of a dynamic energy tariff and a dynamic grid usage tariff.
          The energy tariff and the grid usage tariff can change every 15 minutes, depending on the current electricity market price and grid utilization.
          These two tariff components are calculated according to the same pattern and published daily.</p>
          <p>Additional information on the tariffs can be found <a href="https://www.ekz.ch/de/ueber-ekz/unternehmen/ekz/gesetzliche-vorgaben.html">here</a>.</p>

          <p>Who is the dynamic tariff suitable for?</p>
          <p>The dynamic tariff is aimed at private and business customers with an annual consumption of less than 100,000 kWh.
          It is particularly worthwhile for households and businesses that have large electricity consumers such as electric cars, heat pumps, boilers, or batteries and can control their consumption flexibly and automatically via an energy management system.</p>
          <p>How does the dynamic tariff work?</p>
          <p>With the dynamic tariff, the energy tariff and the grid usage tariff can change every 15 minutes, depending on the current electricity market price and the utilization of the grid.</p>

          <p>These two tariff components change continuously:</p>
          <ul>
            <li>EKZ Energie Dynamisch: Tariff is based on the spot market</li>
            <li>EKZ Netz 400D: Tariff is based on current grid utilization</li>
          </ul>
          <p>This protects you from sharp fluctuations:</p>
          <p>The energy tariff may deviate by a maximum of ±5 cents/kWh from the standard tariff (EKZ Renewable Energy).</p>
          <p>The grid usage tariff may be up to 5 cents/kWh below or up to 15 cents/kWh above the standard grid usage tariff (EKZ Grid 400ST).</p>
          <p>With automatically controlled consumption (via EMS), you can make targeted use of times with favorable rates. This means that the average daily price can be lower than the standard rate.
          Without proper control, however, consumption may fall into expensive time slots and your overall electricity costs may be higher.</p>
          <p>As with all EKZ tariffs, statutory levies and surcharges are also charged.</p>

          <ul>
            <li><strong>Data Update Frequency:</strong>&nbsp;Day-ahead</li>
            <li><strong>Time of Publication:</strong>&nbsp;18:00 on the day before</li>
            <li><strong>Binding Character:</strong>&nbsp;Adjustments can be made until the end of the previous day. If the EKZ API is not available by midnight on the previous day, the standard rate applies. This applies exclusively to the EKZ systems; end customers are responsible for receiving and processing the rate information.</li>
            <li><strong>Non-dynamic Elements:</strong>&nbsp;Basic energy rate, metering rate and additional fees</li>
          </ul>
        ]]>
      </textElement>
      <language>en</language>
      <uri>https://www.ekz.ch/de/privatkunden/strom/tarife/dynamischer-wahltarif.html</uri>
    </legibleDescription>
    <legibleDescription>
      <textElement>
        <![CDATA[
          <p>Der dynamische Tarif von EKZ setzt sich aus einem dynamischen Energie- und einem dynamischen Netznutzungstarif zusammen.
          Der Energietarif und der Netznutzungstarif können dabei alle 15 Minuten ändern, abhängig vom aktuellen Strommarktpreis und der Auslastung des Netzes.
          Diese beiden Tarifkomponenten werden nach demselben Muster berechnet und täglich neu veröffentlicht.</p>
          <p>Weitere Infos zu den Tarifen sind <a href="https://www.ekz.ch/de/ueber-ekz/unternehmen/ekz/gesetzliche-vorgaben.html">hier</a> zu finden.</p>

          <p>Für wen eignet sich der dynamische Tarif?</p>
          <p>Der dynamische Tarif richtet sich an Privat- und Geschäftskunden mit einem Jahresverbrauch unter 100'000 kWh.
          Er lohnt sich besonders für Haushalte und Betriebe, die grosse Stromverbraucher wie Elektroauto, Wärmepumpe, Boiler oder Batterie besitzen und ihren Verbrauch flexibel und automatisch über ein Energiemanagementsystem steuern lassen können.</p>
          <p>Wie funktioniert der dynamische Tarif?</p>
          <p>Beim dynamischen Tarif können sich der Energietarif und der Netznutzungstarif alle 15 Minuten ändern, abhängig vom aktuellen Strommarktpreis und der Auslastung des Netzes.</p>

          <p>Diese beiden Tarifbestandteile ändern sich laufend:</p>
          <ul>
            <li>EKZ Energie Dynamisch: Tarif richtet sich nach dem Spotmarkt</li>
            <li>EKZ Netz 400D: Tarif richtet sich nach der aktuellen Netzauslastung</li>
          </ul>
          <p>So sind Sie vor starken Schwankungen geschützt:</p>
          <p>Der Energietarif kann maximal ±5 Rp./kWh vom Standardtarif (EKZ Energie Erneuerbar) abweichen.</p>
          <p>Der Netznutzungstarif kann bis zu 5 Rp./kWh unter oder bis zu 15 Rp./kWh über dem Standardnetznutzungstarif (EKZ Netz 400ST) liegen.</p>
          <p>Mit einem automatisch gesteuerten Verbrauch (über EMS) können Sie gezielt Zeiten mit günstigen Tarifen nutzen. So kann der durchschnittliche Tagespreis tiefer liegen als im Standardtarif.
          Ohne eine korrekte Steuerung hingegen kann der Verbrauch in teure Zeitfenster fallen und Ihre Stromkosten insgesamt höher ausfallen.</p>
          <p>Wie bei allen EKZ-Tarifen werden zusätzlich die gesetzlichen Abgaben und Zuschläge verrechnet.</p>

          <ul>
            <li><strong>Häufigkeit der Datenaktualisierung:</strong>&nbsp;Day-ahead</li>
            <li><strong>Publikationszeitpunkt:</strong>&nbsp;18:00 Uhr am Vortag</li>
            <li><strong>Verbindlichkeit:</strong>&nbsp;Anpassungen sind bis zum Ende des Vortages möglich. Sofern die API von EKZ bis 24.00 Uhr am Vortag nicht verfügbar ist, gilt der Standardtarif. Dies gilt ausschliesslich für den Teil der EKZ-Systeme; für den Empfang und die Verarbeitung der Tarifinformationen sind die Endkunden verantwortlich.</li>
            <li><strong>Nicht-dynamische Elemente:</strong>&nbsp;Grundtarif Energie, Messtarif sowie Zuschläge und Abgaben</li>
          </ul>
        ]]>
      </textElement>
      <language>de</language>
      <uri>https://www.ekz.ch/de/privatkunden/strom/tarife/dynamischer-wahltarif.html</uri>
    </legibleDescription>
    <deviceCategory>SGCP</deviceCategory>
    <isLocalControl>false</isLocalControl>
    <softwareRevision>1.0.0</softwareRevision>
    <hardwareRevision>-</hardwareRevision>
    <manufacturerSpecificationIdentification>EKZDynamicTariffs</manufacturerSpecificationIdentification>
    <levelOfOperation>m</levelOfOperation>
    <versionNumber>
      <primaryVersionNumber>0</primaryVersionNumber>
      <secondaryVersionNumber>2</secondaryVersionNumber>
      <subReleaseVersionNumber>0</subReleaseVersionNumber>
    </versionNumber>
    <testState>Verified</testState>
    <programmerHints>
      <textElement>
        <![CDATA[
          <p>Link zur technischen Dokumentation:</p>
        ]]>
      </textElement>
      <language>de</language>
      <uri>https://www.ekz.ch/dam/ekz/privatkunden/strom/tarife-und-agb/Tarifdokumente/tarife-2026/EKZ_Dynamischer-Tarif-2026_technischer-Beschrieb.pdf</uri>
    </programmerHints>
  </deviceInformation>
  <configurationList>
    <configurationListElement>
      <name>tariff_type</name>
      <dataType>
        <enum>
          <enumEntry>
            <literal>electricity</literal>
            <description>Electricity</description>
          </enumEntry>
          <enumEntry>
            <literal>grid</literal>
            <description>Grid</description>
          </enumEntry>
          <enumEntry>
            <literal>feed_in</literal>
            <description>Feed-in</description>
          </enumEntry>
          <enumEntry>
            <literal>integrated</literal>
            <description>Electricity with grid fees included</description>
          </enumEntry>
          <enumEntry>
            <literal>regional_fees</literal>
            <description>Regional Fees</description>
          </enumEntry>
        </enum>
      </dataType>
      <defaultValue>integrated</defaultValue>
      <configurationDescription>
        <textElement>The tariff type to get</textElement>
        <language>en</language>
        <label>Tariff Type</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Gewünschter Tarif-Typ</textElement>
        <language>de</language>
        <label>Tarif-Typ</label>
      </configurationDescription>
    </configurationListElement>
    <configurationListElement>
      <name>tariff_name</name>
      <dataType>
        <enum>
          <enumEntry>
            <literal>electricity_dynamic</literal>
            <description>Energie Dynamisch</description>
          </enumEntry>
          <enumEntry>
            <literal>grid_400D</literal>
            <description>Netz 400D</description>
          </enumEntry>
        </enum>
      </dataType>
      <defaultValue>electricity_dynamic</defaultValue>
      <configurationDescription>
        <textElement>The actual tariff product to get</textElement>
        <language>en</language>
        <label>Tariff Name</label>
      </configurationDescription>
      <configurationDescription>
        <textElement>Gewünschtes Tarif-Produkt</textElement>
        <language>de</language>
        <label>Tarif-Name</label>
      </configurationDescription>
    </configurationListElement>
  </configurationList>
  <interfaceList>
    <restApiInterface>
      <restApiInterfaceDescription>
        <restApiInterfaceSelection>URI</restApiInterfaceSelection>
        <restApiUri>https://api.tariffs.ekz.ch</restApiUri>
        <restApiAuthenticationMethod>NoSecurityScheme</restApiAuthenticationMethod>
      </restApiInterfaceDescription>
      <functionalProfileList>
        <functionalProfileListElement>
          <functionalProfile>
            <functionalProfileName>DynamicTariff</functionalProfileName>
            <functionalProfileIdentification>
              <specificationOwnerIdentification>0</specificationOwnerIdentification>
              <functionalProfileCategory>SGCP</functionalProfileCategory>
              <functionalProfileType>DynamicTariff</functionalProfileType>
              <levelOfOperation>m</levelOfOperation>
              <versionNumber>
                <primaryVersionNumber>2</primaryVersionNumber>
                <secondaryVersionNumber>0</secondaryVersionNumber>
                <subReleaseVersionNumber>0</subReleaseVersionNumber>
              </versionNumber>
            </functionalProfileIdentification>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <p>Dynamic electricity tariffs provide a price that can change every 15 minutes.
                  EMS can retrieve the price data from a REST API and optimize energy usage based on the variable price.</p>
                  <p><img src="ressources/dynamic_tariff.svg"/></p>
                  <p>The functional profile is based on the VSE industry document <a href="https://www.strom.ch/de/shop/dynamische-netznutzungstarife-im-verteilnetz-hdn-ch-2025">Dynamic grid usage tariffs in the distribution grid</a>.
                  It describes the JSON schema of the price data and the query parameters the REST API of a tariff supplier has to implement.</p>
                ]]>
              </textElement>
              <language>en</language>
            </legibleDescription>
            <legibleDescription>
              <textElement>
                <![CDATA[
                  <p>Dynamische Stromtarife ermöglichen einen Strompreis, der sich alle 15 Minuten ändern kann.
                  EMS können die Tarifdaten über ein REST API abrufen und den Energieverbrauch anhand des variablen Strompreises optimieren.</p>
                  <p><img src="ressources/dynamic_tariff.svg"/></p>
                  <p>Das Funktionsprofil basiert auf dem VSE-Branchendokument <a href="https://www.strom.ch/de/shop/dynamische-netznutzungstarife-im-verteilnetz-hdn-ch-2025">Dynamische Netznutzungstarife im Verteilnetz</a>.
                  Es beschreibt das JSON-Schema der Tarifdaten und die Abfrage-Parameter, die das REST API eines Tarifanbieters unterstützen muss.</p>
                ]]>
              </textElement>
              <language>de</language>
            </legibleDescription>
          </functionalProfile>
          <dataPointList>
            <dataPointListElement>
              <dataPoint>
                <dataPointName>TariffSupply</dataPointName>
                <dataDirection>R</dataDirection>
                <dataType>
                  <json />
                </dataType>
                <unit>NONE</unit>
                <parameterList>
                  <parameterListElement>
                    <name>start_timestamp</name>
                    <dataType>
                      <string />
                    </dataType>
                    <parameterDescription>
                      <textElement>
                        Begin of tariff period to be queried. Format according ISO 8601: YYYY-MM-DDThh:mm:ssTZD.
                      </textElement>
                      <language>en</language>
                      <label>Period start time stamp</label>
                    </parameterDescription>
                    <parameterDescription>
                      <textElement>
                        Beginn der abzurufenden Tarifperiode. Format gem. ISO 8601: YYYY-MM-DDThh:mm:ssTZD.
                      </textElement>
                      <language>de</language>
                      <label>Start-Zeitpunkt Periode</label>
                    </parameterDescription>
                  </parameterListElement>
                  <parameterListElement>
                    <name>end_timestamp</name>
                    <dataType>
                      <string />
                    </dataType>
                    <parameterDescription>
                      <textElement>
                        End of tariff period to be queried. Format according ISO 8601: YYYY-MM-DDThh:mm:ssTZD.
                      </textElement>
                      <language>en</language>
                      <label>Period end time stamp</label>
                    </parameterDescription>
                    <parameterDescription>
                      <textElement>
                        Ende der abzurufenden Tarifperiode. Format gem. ISO 8601: YYYY-MM-DDThh:mm:ssTZD.
                      </textElement>
                      <language>de</language>
                      <label>End-Zeitpunkt Periode</label>
                    </parameterDescription>
                  </parameterListElement>
                </parameterList>
                <legibleDescription>
                  <textElement>
                    <![CDATA[
The schema of the JSON response returned by the REST API is

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Dynamic Tariffs",
  "description": "JSON schema for the delivery of dynamic tariff price values",
  "type": "object",
  "properties": {
    "publication_timestamp": {
      "description": "Time of tariff publication",
      "$ref": "#/$defs/timestamp_type"
    },
    "prices": {
      "description": "Price values",
      "type": "array",
      "items": { "$ref": "#/$defs/price_item" }
    }
  },
  "additionalProperties": true,
  "required": [
    "publication_timestamp",
    "prices"
  ],
  "$defs": {
    "price_item": {
      "type": "object",
      "properties": {
        "start_timestamp": {
          "description": "Start time stamp of the tariff interval",
          "$ref": "#/$defs/timestamp_type"
        },
        "end_timestamp": {
          "description": "End time stamp of the tariff interval",
          "$ref": "#/$defs/timestamp_type"
        },
        "electricity": {
          "description": "Electricity price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "feed_in": {
          "description": "Feed-in price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "grid": {
          "description": "Grid price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "integrated": {
          "description": "Integrated price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "regional_fees": {
          "description": "Regional fee price values in the interval",
          "$ref": "#/$defs/price_component_array"
        }
      },
      "additionalProperties": true,
      "required": [
        "start_timestamp",
        "end_timestamp"
      ]
    },
    "price_component_item": {
      "type": "object",
      "properties": {
        "unit": {
          "description": "The tariff unit of the price value",
          "type": "string"
        },
        "value": {
          "description": "The tariff price value",
          "type": "number"
        }
      },
      "additionalProperties": true,
      "required": [
        "unit",
        "value"
      ]
    },
    "timestamp_type": {
      "description": "ISO-8601 time stamp",
      "anyOf": [
        { "type": "string", "format": "date-time" },
        { "type": "string", "format": "empty" },
        { "type": "null" }
      ]
    },
    "price_component_array": {
      "description": "Nullable array",
      "anyOf": [
        { "type": "array", "items": { "$ref": "#/$defs/price_component_item" }},
        { "type": "null" }
      ]
    }
  }
}
</pre></font>

A JSON example is:

<font size="1"><pre style="color:blue">
{
  "publication_timestamp": "2025-01-01T00:00:00+01:00",
  "prices": [
    {
      "start_timestamp": "2025-01-01T00:00:00+01:00",
      "end_timestamp": "2025-01-01T00:15:00+01:00",
      "integrated": [
        {
          "unit": "CHF_kWh",
          "value": 0.4925
        }
      ]
    },
    {
      "start_timestamp": "2025-01-01T00:15:00+01:00",
      "end_timestamp": "2025-01-01T00:30:00+01:00",
      "integrated": [
        {
          "unit": "CHF_kWh",
          "value": 0.491133
        }
      ]
    }
  ]
}
</pre></font>
                    ]]>
                  </textElement>
                  <language>en</language>
                </legibleDescription>
                <legibleDescription>
                  <textElement>
                    <![CDATA[
Das Schema der JSON-Response des REST API ist

<font size="1"><pre style="color:blue">
{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "Dynamic Tariffs",
  "description": "JSON schema for the delivery of dynamic tariff price values",
  "type": "object",
  "properties": {
    "publication_timestamp": {
      "description": "Time of tariff publication",
      "$ref": "#/$defs/timestamp_type"
    },
    "prices": {
      "description": "Price values",
      "type": "array",
      "items": { "$ref": "#/$defs/price_item" }
    }
  },
  "additionalProperties": true,
  "required": [
    "publication_timestamp",
    "prices"
  ],
  "$defs": {
    "price_item": {
      "type": "object",
      "properties": {
        "start_timestamp": {
          "description": "Start time stamp of the tariff interval",
          "$ref": "#/$defs/timestamp_type"
        },
        "end_timestamp": {
          "description": "End time stamp of the tariff interval",
          "$ref": "#/$defs/timestamp_type"
        },
        "electricity": {
          "description": "Electricity price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "feed_in": {
          "description": "Feed-in price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "grid": {
          "description": "Grid price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "integrated": {
          "description": "Integrated price values in the interval",
          "$ref": "#/$defs/price_component_array"
        },
        "regional_fees": {
          "description": "Regional fee price values in the interval",
          "$ref": "#/$defs/price_component_array"
        }
      },
      "additionalProperties": true,
      "required": [
        "start_timestamp",
        "end_timestamp"
      ]
    },
    "price_component_item": {
      "type": "object",
      "properties": {
        "unit": {
          "description": "The tariff unit of the price value",
          "type": "string"
        },
        "value": {
          "description": "The tariff price value",
          "type": "number"
        }
      },
      "additionalProperties": true,
      "required": [
        "unit",
        "value"
      ]
    },
    "timestamp_type": {
      "description": "ISO-8601 time stamp",
      "anyOf": [
        { "type": "string", "format": "date-time" },
        { "type": "string", "format": "empty" },
        { "type": "null" }
      ]
    },
    "price_component_array": {
      "description": "Nullable array",
      "anyOf": [
        { "type": "array", "items": { "$ref": "#/$defs/price_component_item" }},
        { "type": "null" }
      ]
    }
  }
}
</pre></font>

Ein JSON-Beispiel ist:

<font size="1"><pre style="color:blue">
{
  "publication_timestamp": "2025-01-01T00:00:00+01:00",
  "prices": [
    {
      "start_timestamp": "2025-01-01T00:00:00+01:00",
      "end_timestamp": "2025-01-01T00:15:00+01:00",
      "integrated": [
        {
          "unit": "CHF_kWh",
          "value": 0.4925
        }
      ]
    },
    {
      "start_timestamp": "2025-01-01T00:15:00+01:00",
      "end_timestamp": "2025-01-01T00:30:00+01:00",
      "integrated": [
        {
          "unit": "CHF_kWh",
          "value": 0.491133
        }
      ]
    }
  ]
}
</pre></font>
                    ]]>
                  </textElement>
                  <language>de</language>
                </legibleDescription>
              </dataPoint>
              <restApiDataPointConfiguration>
                <dataType>JSON_object</dataType>
                <restApiReadServiceCall>
                  <requestHeader>
                    <header>
                      <headerName>Accept</headerName>
                      <value>application/json</value>
                    </header>
                  </requestHeader>
                  <requestMethod>GET</requestMethod>
                  <requestPath>/v1/tariffs</requestPath>
                  <requestQuery>
                    <parameter>
                      <name>tariff_type</name>
                      <value>{{tariff_type}}</value>
                    </parameter>
                    <parameter>
                      <name>tariff_name</name>
                      <value>{{tariff_name}}</value>
                    </parameter>
                    <parameter>
                      <name>start_timestamp</name>
                      <value>[[start_timestamp]]</value>
                    </parameter>
                    <parameter>
                      <name>end_timestamp</name>
                      <value>[[end_timestamp]]</value>
                    </parameter>
                  </requestQuery>
                </restApiReadServiceCall>
              </restApiDataPointConfiguration>
            </dataPointListElement>
          </dataPointList>
        </functionalProfileListElement>
      </functionalProfileList>
    </restApiInterface>
  </interfaceList>
</DeviceFrame>